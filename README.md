# Dosimeter-SQUICK
Представляю вашему вниманию дозиметр-радиометр "писк". Дозиметр был разработан как давняя мечта, ещё с времён игры в сталкер.
Моей целью было разработать максимально дешёвое и надёжное устройство, и в дальнейшем отдать его на "растерзание публики".
Весь программный код доступен под лицензией MIT, то есть при редактировании должна быть ссылка на оригинал.
## Начну с аппаратной части: 
  Главным мозгом устройства является микроконтроллер atmega328p-au. Именно этот микроконтроллер был выбран только из за своей доступности.
  За отображение информации отвечает 4х разрядный семисегментный индикатор с общим анодом, микросхема TM1637 и три светодиода отвечающие за диапазон (микро, милли и рентген).
  Генерация высокого напряжения реализована на irf840, диоде HER106, конденсаторе и катушке индуктивности (Сопротивление ~5 Ом). В общем обычный dc-dc с микроконтроллерным управлением.
  Резисторы от R17-R31 отвечают за делитель напряжения для чтения данных о напряжении на генераторе.
Снятие показаний происходит с помощью эмиттерного повторителя на кт315, и идёт на вход прерываний INT0.
  Что по питанию. По питанию использована микросхема ME2108A50PG, которая отвечает за повышение напряжения до 5 вольт, и зарядное устройство для литиевых аккумуляторов на tp4056. Разъём Micro USB нужен число для зарядки устройства.
  Немного забегая вперёд, в новой версии скорее всего будет использован микроконтроллер atmega328p-mu, то есть военный, говорят что при высоком фоне он не будет тупить. Но я и не уверен что текущий будет сильно тупить.
## Программная часть:
  Начну с того, что вам нужно иметь программатор для того чтобы прошить устройство. Программаторы перечислены в файле platformio.ini, где и нужно будет в дальнейшем выбирать каким образом прошивать. Сразу говорю, как ардуино прошить нельзя, программатор нужен обязательно.
  И так. Platformio это плагин для программы Visual Studio Code, который упрощает разработку под микроконтроллеры, следовательно нужно сначала скачать саму IDE, и после установки platformio открыть скачаный проект уже в программе. О том как работать с этой средой можно посмотреть на ютубе, по этому не буду углубляться, по сути это как в arduino ide, только удобнее.
  Сразу скажу, что отправной точкой проекта была эта статья: https://cxem.net/dozimetr/3-10.php
  Огромное спасибо автору, т.к. пока я разбирался в его коде, я начал больше понимать в регистрах avr.
  Программное обеспечение постепенно обновляется, и с каждой версией оно будет ещё более быстрым и энергоэффективным. Я не буду углубляться в алгоритм счёта, так как он уже вприведён в выше указанной статье. Скажу только что работает он вполне сносно, и расхождение измерений с теми что были у пользователей на youtube не более 5% (Проверялось на хлориде калия).
  Плюсом самого устройства является то что в принципе можно подключить практически любой счётчик, и в самом приборе установить для него напряжение и время счёта, которые можно найти в характеристиках счётчика.
## Пользовательский интерфейс:
  Это довольно сложная часть, т.к. имея две кнопки и семисегментный дисплей было довольно сложно добавить удобное меню.
  Давайте по порядку. Когда вы включаете устройство, оно переходит в первый режим, это режим поиск. Как понятно из названия, этот режим показывает текущий фон, и зависит от времени счёта. Теперь к тому, что можно делать на экране выбранного режима.
  -Долгое удержание кнопки reset сбрасывает показания.
  -Короткое нажатие кнопки reset показывает текущий режим.
  -Долгое нажатие кнопки set переводит устройство в спящий режим.
  -Короткое нажатие кнопки set на данном экране ничего не делает.
  -Удержание обеих кнопок переводит устройство в выбор режима.
  Навигация в меню следующая:
    -Долгое удержание кнопки reset выходит из меню.
    -Короткое нажатие кнопки reset предыдущий режим.
    -Долгое нажатие кнопки set выбрать режим.
    -Короткое нажатие кнопки set следующий режим.
  В кратце пробежимся по режимам:
  1. Первый режим background, то есть текущий фон. Показывает текущий фон в рентгенах( Зависит от светодиода диапазона, но об этом позже)
  2. Второй режим это число засечённых частиц за сеанс. На данный момент доза не сохраняется, но это будет добавлено в новой версии прошивки.
  3. Третий режим, максимум фона. Показывает пиковое значение фона засечённое за сеанс.
  4. Четвёртый режим, показывает накопленную дозу за сеанс, так же будет улучшен в будующем.
  5. Пятый режим это установка рабочего напряжения. На экран выводится значение в вольтах с генератора. Одиночное нажатие кнопок set и reset регулирует напряжение. Долгое удержание кнопки set сохраняет установленное значение, а удержание кнопки reset выходит обратно в меню.
  6. Шестой режим это установка времени счёта. Время в секундах, и максимальное время 255 сек. Управление идентично предыдущему режиму.
  7. Седьмой режим это установка тональности пищалки, управление идентичное двум предыдущим режимам.
  8. Ну и восьмой режим показывает напряжение на батарее в вольтах.
В принципе это всё на данный момент, прошивка будет постепенно улучшаться, и в будующем возможно будет новая версия устройства с новым дисплеем, который будет более информанивен, хотя возможно менее надёжет.
## Будет добавлено:
  -Сохранение накопленой дозы в памяти
  -Защита от переразряда аккумулятора (Программная)
  -Увеличенная энергоэффективность
  -Увеличенная скорость работы.
Проект полностью открыт, можете заказывать печатную плату на jlcpcb.
Если хотите поддержать разработчика вот мой киви: +79525500562 или webmoney: R530142330941
Первая версия печатной платы: https://easyeda.com/AdamFull/geigercounter
Версия с эераном от нокии 5110: https://easyeda.com/AdamFull/geigercounter_nokia
